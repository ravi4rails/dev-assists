<div class="container">
  <div class="row">
    <div class="col-md-7">
      <% @developers.each do |developer| %>
        <div class="card mt-3 mb-3">
          <div class="card-body">
            <div class="row">
              <div class="col-md-4">
                <%= image_tag developer.profile_photo.url, style: "width:140px;height:140px;border-radius:50%;border:2px solid #ccc;"  if developer.profile_photo.present? %>
              </div>
              <div class="col-md-8">
                <h3><%= developer.first_name%> <%= developer.last_name%></h3>
                <hr>
                <p>Email: <%= developer.email %></p>
                <p>Contact Number: <%= developer.contact_number %></p>
                <p>Address: <%= developer.permanent_address %></p>
                <p>City: <%= developer.city %></p>
                <p>Zipcode: <%= developer.zipcode %></p>
                <p>State: <%= developer.state %></p>
                <p>Country <%= developer.country %></p>
              </div>
            </div>
          </div>
        </div>
      <% end %>
    </div>
    <div class="col-md-5">
      <div id="map"></div>
    </div>
  </div>
</div>
<style type="text/css">
  #map {
    width: 110%;
    height:100%;
  }
</style>

<script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBFBYM37YGMTdgkEp9fipPljSjprTDZL8Y">
</script>

<script type="text/javascript">
  var locations = [];

  <% @developers.all.each do |developer| %>
    locations.push(["<%= developer.country %>", <%= developer.latitude %>, <%= developer.longitude %>, "<%= developer.name.titleize %>"]);
  <% end %>

  var map = new google.maps.Map(document.getElementById('map'), {
    zoom: 14,
    center: new google.maps.LatLng(locations[0][1], locations[0][2]),
    mapTypeId: google.maps.MapTypeId.ROADMAP
  });

  var infowindow = new google.maps.InfoWindow();

  var marker, i;

  for (i = 0; i < locations.length; i++) {  
    marker = new google.maps.Marker({
      position: new google.maps.LatLng(locations[i][1], locations[i][2]),
      map: map
    });

    developer_name = locations[i][3];
    developer_country = locations[i][0];
    
    var infowindow = new google.maps.InfoWindow({
      content: developer_name + " <br> <font style='color:#fc9a01;'>from <b>"+ developer_country+ "</b></font>"
    });
    infowindow.open(map, marker);

    google.maps.event.addListener(marker, 'click', (function(marker, map) {
      infowindow.open(map, marker);
    })(marker, map));
  }

</script>
